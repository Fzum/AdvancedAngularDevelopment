<div fxLayout="column">
  <!-- Title & Subtitle -->

  <mat-card *ngIf="!editMode">
    <mat-card-header>
      <mat-card-title>{{ marker.lable }}</mat-card-title>
      <mat-card-subtitle> {{ getMarkerType(marker.type) }} </mat-card-subtitle>
    </mat-card-header>
  </mat-card>

  <mat-card *ngIf="editMode">
    <mat-card-content>
      <mat-form-field>
        <input matInput placeholder="Label" [(ngModel)]="marker.lable" />
      </mat-form-field>

      <mat-form-field>
        <mat-select [(value)]="marker.type" placeholder="Type">
          <mat-option [value]="0">Unclassified</mat-option>
          <mat-option [value]="1">Beeren</mat-option>
          <mat-option [value]="2">Holler</mat-option>
          <mat-option [value]="3">Schwammerl</mat-option>
        </mat-select>
      </mat-form-field>
    </mat-card-content>
  </mat-card>

  <!-- Image -->
  <mat-card>
    <mat-card-content>
      <img
        class="imgMain"
        [src]="marker.imgURL"
        [style.height.px]="imgHeight"
      />
    </mat-card-content>
    <mat-card-actions *ngIf="editMode" align="end">
      <button mat-mini-fab (click)="takePicture()">
        <mat-icon>camera_enhance</mat-icon>
      </button>
    </mat-card-actions>
  </mat-card>

  <!-- Remark -->
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        Anmerkung
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <ng-container *ngIf="!editMode">
        {{ marker.remark }}
      </ng-container>
      <ng-container *ngIf="editMode">
        <mat-form-field>
          <textarea
            matInput
            rows="3"
            placeholder="Anmerkung"
            [(ngModel)]="marker.remark"
          ></textarea>
        </mat-form-field>
      </ng-container>
    </mat-card-content>
  </mat-card>

  <!-- Location -->
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        Standort
      </mat-card-title>
    </mat-card-header>

    <mat-card-content fxLayout="row" fxLayoutAlign="space-between center">
      <div *ngIf="marker.hasCoords">
        Long: {{ marker.lng }} / Lat: {{ marker.lat }}
      </div>
      <div class="rightCell" fxFlex="1 1 30%" fxFlexAlign="center">
        <button
          mat-mini-fab
          (click)="watchDirection()"
          *ngIf="marker.hasCoords && !editMode"
        >
          <mat-icon>navigation</mat-icon>
        </button>
        <button mat-mini-fab (click)="setMarkerLocation()" *ngIf="editMode">
          <mat-icon aria-label="Click to get Postistion"
            >not_listed_location</mat-icon
          >
        </button>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Map -->
  <mat-card *ngIf="marker.hasCoords && editMode == false && online">
    <mat-card-content>
      <agm-map [latitude]="marker.lat" [longitude]="marker.lng">
        <agm-marker
          [latitude]="marker.lat"
          [longitude]="marker.lng"
        ></agm-marker>
        <agm-direction
          *ngIf="showDirection"
          [origin]="direction.origin"
          [destination]="direction.destination"
        ></agm-direction>
      </agm-map>
    </mat-card-content>
  </mat-card>

  <!-- Commands -->
  <mat-card>
    <mat-card-content
      fxLayout="row"
      fxLayoutAlign="center center"
      fxLayoutGap="20px"
    >
      <mat-slide-toggle
        *ngIf="marker.hasCoords && !editMode"
        [(ngModel)]="showWeather"
        >Show Weather</mat-slide-toggle
      >
      <button mat-mini-fab (click)="toggleEdit()" *ngIf="!editMode">
        <mat-icon>edit</mat-icon>
      </button>
      <button mat-mini-fab (click)="saveMarker()" *ngIf="editMode">
        <mat-icon>save</mat-icon>
      </button>
      <button mat-mini-fab (click)="toggleEdit()" *ngIf="editMode">
        <mat-icon>cancel</mat-icon>
      </button>
    </mat-card-content>
  </mat-card>

  <!-- Weather -->
  <mat-card *ngIf="showWeather && marker.hasCoords && !editMode">
    <div
      style="background-image: url('assets/images/wetter.png'); background-position: center center; background-repeat: no-repeat; background-size: cover; width: 100%; height: 100px;"
    ></div>
  </mat-card>
</div>
